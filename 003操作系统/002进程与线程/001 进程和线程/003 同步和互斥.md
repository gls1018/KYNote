### 1. 同步和互斥的概念

**临界资源**：一次只能为一个进程使用的资源就叫临界资源，比如打印机



```cpp
while(1)
{
    entry section;
    critical section;
    exit section;
    remainder section;
}
```

- 进入区：检查临界资源是否可进，若可进，则设置正在访问临界资源的标志
- 临界区：访问临界资源的那段代码
- 退出区：将正在访问临界资源的标志清除
- 剩余区: 代码中其它部分





**同步：**直接制约关系，例如，A向管道中写数据，B从管道中读数据，只有A先写，B才能读，A和B同步

**互斥：**间接制约关系，例如A和B都要使用打印机资源，但是打印机一次只能被一个进程使用，A和B之间互斥。



**临界区的准则:**

- 空闲让进
- 忙则等待
- 有限等待：要保证进程在有限时间内进入临界区，不能无限等待
- 让权等待：（原则上应该，但非必须）当进程不能进入临界区，应该让出CPU，防止进程忙等



### 2. 实现临界区的方法



**软件实现方法**

- 单标志法
- 双标志检查法
- 双标志后检查法
- PeterSon算法















**硬件实现方法**

- 中断屏蔽方法
- 硬件指令方法 -- TestAndSet指令
- 硬件指令方法 -- Swap指令





**中断屏蔽方法**

因为CPU只会在发生中断时才会引起进程切换，因此关闭中断，能够保证当前运行的进程顺利执行完临界区代码。执行完后再开中断

```
...
关中断
临界区
开中断
...
```

缺点:

- 限制了CPU的交替执行程序的能力，效率明显降低
- 将关中断的权限交给用户很不明智，若一个进程关中断后不开中断，系统会崩溃
- 不适用与多处理器系统，一个CPU上关中断，不影响进程在其他CPU上执行临界区代码



**硬件指令方法 -- TestAndSet指令** 

### 3. 互斥锁



### 4. 信号量



